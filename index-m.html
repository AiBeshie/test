<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Mini PokÃ©mon RPG â€” Mobile</title>
  <link rel="stylesheet" href="style/style.css">
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
    /* Reset & base styles */
    html, body {
      margin: 0;
      padding: 0;
      overflow-x: hidden;
      height: 100%;
      font-family: 'Press Start 2P', monospace;
    }

    /* Main GBA screen */
    #gbaScreen {
      position: relative;
      width: 100%;
      height: 100vh;
      background: #eee;
      z-index: 1;
      overflow: hidden;
    }

    /* Scrollable GBA shell */
    .gba-shell {
      overflow-x: auto;
      height: 100%;
    }

    /* Panels */
    .side-panel {
      position: fixed;
      background: #fff;
      box-shadow: 2px 0 5px rgba(0,0,0,0.3);
      overflow-y: auto;
      transition: transform 0.3s ease;
      padding: 10px;
      z-index: 900;
      pointer-events: none;
    }

    #leftPanel { top:0; bottom:0; left:0; width:220px; transform: translateX(-100%); }
    #rightPanel { top:0; bottom:0; right:0; width:220px; transform: translateX(100%); }
    #bottomPanel { left:0; right:0; bottom:0; height:220px; transform: translateY(100%); }

    .side-panel.active { transform: translateX(0) translateY(0); pointer-events: auto; }

    /* Mobile toggle button */
    #viewToggleBtn {
      position: fixed;
      top: 10px;
      right: 10px;
      z-index: 1001;
      padding: 6px 10px;
      font-size: 0.9em;
      background: #ff9800;
      color: #fff;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
  </style>
</head>
<body class="mobile-view">

  <!-- Mobile toggle -->
  <button id="viewToggleBtn">ðŸ”™ Back to PC View</button>

  <header>
    <h4>Mini PokÃ©mon RPG â€” Mobile</h4>
    <p class="small">Routes â€¢ Wild Encounters â€¢ EXP â€¢ Items â€¢ Coins â€¢ Save/Load</p>
  </header>

  <!-- Main GBA Battle Screen -->
  <div id="gbaScreen">
    <div class="gba-shell">
      <div class="battle-screen">
        <!-- Enemy PokÃ©mon -->
        <div class="enemy-container">
          <div class="hp-box">
            <div class="name-level">
              <span id="wildName">â€”</span> Lv:<span id="wildLevel">0</span>
              <span id="wildCP" class="cp-display">â€¢ CP 0</span>
            </div>
            <div class="bars-row">
              <div class="hp-bar-outer hp-horizontal"><div id="enemyHPBar" class="hp-bar-inner hp-green"></div></div>
              <div class="hp-bar-outer hp-horizontal"><div id="enemyEnergyBar" class="hp-bar-inner hp-blue"></div></div>
            </div>
            <div class="hp-text">
              <span id="enemyHP">0</span>/<span id="enemyHPMax">0</span>
              | Energy: <span id="enemyEnergy">0</span>/<span id="enemyMaxEnergy">100</span>
            </div>
          </div>
          <img id="wildSprite" src="" alt="Wild PokÃ©mon" class="pokemon-sprite">
        </div>

        <!-- Player PokÃ©mon -->
        <div class="player-container">
          <img id="playerSprite" src="" alt="Player PokÃ©mon" class="pokemon-sprite">
          <img id="pokeballThrow" src="img/greatball.png" style="position:absolute; left:-50%; top:70%; width:40px; height:40px; transform:translateX(-50%) translateY(0); display:none;" alt="PokÃ©ball">
          <div class="hp-box">
            <div class="name-level">
              <span id="activeName">â€”</span> Lv:<span id="activeLevel">0</span>
              <span id="playerCP" class="cp-display">â€¢ CP 0</span>
            </div>
            <div class="bars-row">
              <div class="hp-bar-outer hp-horizontal"><div id="playerHPBar" class="hp-bar-inner hp-green"></div></div>
              <div class="hp-bar-outer hp-horizontal"><div id="playerEnergyBar" class="hp-bar-inner hp-blue"></div></div>
            </div>
            <div class="hp-text">
              <span id="playerHP">0</span>/<span id="playerHPMax">0</span>
              | Energy: <span id="playerEnergy">0</span>/<span id="playerMaxEnergy">100</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Moves & Items -->
      <div class="moves-box">
        <p class="small">Current Route: <span id="currentRoute">None</span></p>
        <div class="move-buttons">
          <button id="searchWildBtn" onclick="encounterWild()" class="primary">Search Wild</button>
          <button onclick="playerTurn('flee')">Flee</button>
        </div>
        <div class="move-buttons">
          <button id="move0" onclick="playerTurn('attack',{moveIndex:0})">â€”</button>
          <button id="move1" onclick="playerTurn('attack',{moveIndex:1})">â€”</button>
          <button id="move2" onclick="playerTurn('attack',{moveIndex:2})">â€”</button>
          <button id="move3" onclick="playerTurn('attack',{moveIndex:3})">â€”</button>
        </div>
        <div>Items
          <p id="itemsDisplay"></p>
        </div>
      </div>
    </div>
  </div>

  <!-- Side Panels -->
  <div class="side-panel" id="leftPanel">
    <h2>Player / Map</h2>
    <div id="playerPanelContent"></div>
  </div>

  <div class="side-panel" id="rightPanel">
    <h2>Storage</h2>
    <div id="storagePanelContent"></div>
  </div>

  <div class="side-panel" id="bottomPanel">
    <h2>Map / Routes</h2>
    <div id="mapPanelContent"></div>
  </div>

  <script>
    // Dark mode toggle
    if(localStorage.getItem('darkMode') === 'true') document.body.classList.add('dark-mode');
    function toggleDarkMode() {
      document.body.classList.toggle('dark-mode');
      localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
    }

    // Mobile toggle back to PC view
    document.getElementById('viewToggleBtn').addEventListener('click', () => {
      window.location.href = 'index.html';
    });

    // Swipe gesture for panels
    let startX, startY;
    const leftPanel = document.getElementById('leftPanel');
    const rightPanel = document.getElementById('rightPanel');
    const bottomPanel = document.getElementById('bottomPanel');
    const gbaScreen = document.getElementById('gbaScreen');

    gbaScreen.addEventListener('touchstart', e => {
      startX = e.touches[0].clientX;
      startY = e.touches[0].clientY;
    });

    gbaScreen.addEventListener('touchend', e => {
      const endX = e.changedTouches[0].clientX;
      const endY = e.changedTouches[0].clientY;

      const dx = endX - startX;
      const dy = endY - startY;

      // Horizontal swipe
      if(Math.abs(dx) > 50 && Math.abs(dx) > Math.abs(dy)){
        if(dx > 0 && startX < 50) leftPanel.classList.add('active');
        else if(dx < 0 && startX > window.innerWidth - 50) rightPanel.classList.add('active');
      }

      // Vertical swipe from bottom
      if(Math.abs(dy) > 50 && Math.abs(dy) > Math.abs(dx)){
        if(dy < 0 && startY > window.innerHeight - 50) bottomPanel.classList.add('active');
      }
    });

    // Tap GBA to close panels
    gbaScreen.addEventListener('click', () => {
      leftPanel.classList.remove('active');
      rightPanel.classList.remove('active');
      bottomPanel.classList.remove('active');
    });
  </script>

  <!-- Game scripts -->
  <script src="data/movesdb.js"></script>
  <script src="data/pokemondb.js"></script>
  <script src="data/pokemonImages.js"></script>
  <script src="data/routes.js"></script>
  <script src="js/game.js"></script>
  <script src="js/battle.js"></script>
  <script src="js/journey.js"></script>
  <script src="js/player.js"></script>
  <script src="js/item.js"></script>
  <script src="util/settings.js"></script>

</body>
</html>